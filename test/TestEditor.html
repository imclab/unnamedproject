<!doctype html>
<html>
  <head>
    <title>Test the Editor.js Component</title>
    <link rel="stylesheet" href="qunit.css">
    <script src="qunit.js"></script>
    <script src="../src/js/editor.js"></script>
  </head>
  <body>
    <h1 id="qunit-header">Editor.js Test</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <div id="qunit-fixture">
      <aside>Counts: <output id="wordcount">0</output>&nbsp;words <output id="charcount">0</output>&nbsp;chars</aside>
      <div id="editor" contenteditable="true"></div>
    </div>
    <script>
      module("Text Processing", {
        setup: function () {
          this.editor_ = new Editor('editor');
        },
        teardown: function () {
          this.editor_ = null;
        } 
      });
      test("Replace & and < and >.", function () {
        equal(
          this.editor_.processText_("& &amp;"),
          "<pre>&amp; &amp;amp;</pre>",
          "& is correctly replaced."
        );
        equal(
          this.editor_.processText_("<this is code>"),
          "<pre>&lt;this is code&gt;</pre>",
          "< and > are correctly replaced."
        );
      });

    /* STRONG */
      test("Single-word strength.", function () {
        equal(
          this.editor_.processText_("**strong**"),
          "<pre><strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong></pre>",
          "**strong** => <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("[**strong**]"),
          "<pre>[<strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>]</pre>",
          "[**strong**] => <strong>[&#x2a;&#x2a;strong&#x2a;&#x2a;]</strong>"
        );
        equal(
          this.editor_.processText_("first **strong**"),
          "<pre>first <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong></pre>",
          "first **strong** => <strong>first &#x2a;&#x2a;strong&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("**strong** last"),
          "<pre><strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong> last</pre>",
          "**strong** last => <strong>&#x2a;&#x2a;strong&#x2a;&#x2a; last</strong>"
        );
        equal(
          this.editor_.processText_("sentence **strong**."),
          "<pre>sentence <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>.</pre>",
          "sentence **strong**. => <strong>sentence &#x2a;&#x2a;strong&#x2a;&#x2a;.</strong>"
        );
        equal(
          this.editor_.processText_("sentence **strong**,"),
          "<pre>sentence <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>,</pre>",
          "sentence **strong**, => <strong>sentence &#x2a;&#x2a;strong&#x2a;&#x2a;,</strong>"
        );
        equal(
          this.editor_.processText_("sentence **strong**;"),
          "<pre>sentence <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>;</pre>",
          "sentence **strong**; => <strong>sentence &#x2a;&#x2a;strong&#x2a;&#x2a;;</strong>"
        );
        equal(
          this.editor_.processText_("sentence **strong**:"),
          "<pre>sentence <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>:</pre>",
          "sentence **strong**: => <strong>sentence &#x2a;&#x2a;strong&#x2a;&#x2a;:</strong>"
        );
        equal(
          this.editor_.processText_("**strong** **also**"),
          "<pre><strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong> <strong>&#x2a;&#x2a;also&#x2a;&#x2a;</strong></pre>",
          "**strong** **strong** => <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong> <strong>&#x2a;&#x2a;strong&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("**ita**lic**"),
          "<pre><strong>&#x2a;&#x2a;ita**lic&#x2a;&#x2a;</strong></pre>",
          "**ita**lic** => <strong>&#x2a;&#x2a;ita**lic&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("**ita**lic** and **also**"),
          "<pre><strong>&#x2a;&#x2a;ita**lic&#x2a;&#x2a;</strong> and <strong>&#x2a;&#x2a;also&#x2a;&#x2a;</strong></pre>",
          "**ita**lic** and **also** => <strong>&#x2a;&#x2a;ita**lic&#x2a;&#x2a;</strong> and <strong>&#x2a;&#x2a;also&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("**ita**lic**text**is**hard**to**parse**"),
          "<pre><strong>&#x2a;&#x2a;ita**lic**text**is**hard**to**parse&#x2a;&#x2a;</strong></pre>",
          "**ita**lic**text**is**hard**to**parse** => <strong>&#x2a;&#x2a;ita**lic**text**is**hard**to**parse&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("not**strong**text"),
          "<pre>not**strong**text</pre>",
          "not**strong**text => not**strong**text"
        );
      });
      test("Multiple-word strong.", function () {
        equal(
          this.editor_.processText_("**strong text**"),
          "<pre><strong>&#x2a;&#x2a;strong text&#x2a;&#x2a;</strong></pre>",
          "_strong text_ => <strong>&#x2a;&#x2a;strong text&#x2a;&#x2a;</strong>"
        );
        equal(
          this.editor_.processText_("**str**ong te**xt**"),
          "<pre><strong>&#x2a;&#x2a;str**ong te**xt&#x2a;&#x2a;</strong></pre>",
          "**str**ong te**xt** => <strong>&#x2a;&#x2a;str**ong te*xt&#x2a;&#x2a;</strong>"
        );
      });

    /* EM */
      test("Single-word Emphasis.", function () {
        equal(
          this.editor_.processText_("_italic_"),
          "<pre><em>&#x5f;italic&#x5f;</em></pre>",
          "_italic_ => <em>&#x5f;italic&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("[_italic_]"),
          "<pre>[<em>&#x5f;italic&#x5f;</em>]</pre>",
          "[_italic_] => [<em>&#x5f;italic&#x5f;</em>]"
        );
        equal(
          this.editor_.processText_("first _italic_"),
          "<pre>first <em>&#x5f;italic&#x5f;</em></pre>",
          "first _italic_ => first <em>&#x5f;italic&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("sentence _italic_."),
          "<pre>sentence <em>&#x5f;italic&#x5f;</em>.</pre>",
          "sentence _italic_. => sentence <em>&#x5f;italic&#x5f;.</em>"
        );
        equal(
          this.editor_.processText_("sentence _italic_,"),
          "<pre>sentence <em>&#x5f;italic&#x5f;</em>,</pre>",
          "sentence _italic_, => sentence <em>&#x5f;italic&#x5f;,</em>"
        );
        equal(
          this.editor_.processText_("sentence _italic_;"),
          "<pre>sentence <em>&#x5f;italic&#x5f;</em>;</pre>",
          "sentence _italic_; => sentence <em>&#x5f;italic&#x5f;;</em>"
        );
        equal(
          this.editor_.processText_("sentence _italic_:"),
          "<pre>sentence <em>&#x5f;italic&#x5f;</em>:</pre>",
          "sentence _italic_: => sentence <em>&#x5f;italic&#x5f;:</em>"
        );
        equal(
          this.editor_.processText_("caret _italic_{{ CARETMARKER }}"),
          "<pre>caret <em>&#x5f;italic&#x5f;</em><mark id=\"caretmarker\"></mark></pre>",
          "caret _italic_| => caret _italic_<mark id=\"caretmarker\"></mark>"
        );
        equal(
          this.editor_.processText_("_italic_ last"),
          "<pre><em>&#x5f;italic&#x5f;</em> last</pre>",
          "_italic_ last => <em>&#x5f;italic&#x5f; last</em>"
        );
        equal(
          this.editor_.processText_("_italic_ _also_"),
          "<pre><em>&#x5f;italic&#x5f;</em> <em>&#x5f;also&#x5f;</em></pre>",
          "_italic_ _italic_ => <em>&#x5f;italic&#x5f;</em> <em>&#x5f;italic&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("_ita_lic_"),
          "<pre><em>&#x5f;ita_lic&#x5f;</em></pre>",
          "_ita_lic_ => <em>&#x5f;ita_lic&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("_ita_lic_ and _also_"),
          "<pre><em>&#x5f;ita_lic&#x5f;</em> and <em>&#x5f;also&#x5f;</em></pre>",
          "_ita_lic_ and _also_ => <em>&#x5f;ita_lic&#x5f;</em> and <em>&#x5f;also&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("_ita_lic_text_is_hard_to_parse_"),
          "<pre><em>&#x5f;ita_lic_text_is_hard_to_parse&#x5f;</em></pre>",
          "_ita_lic_text_is_hard_to_parse_ => <em>&#x5f;ita_lic_text_is_hard_to_parse&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("not_italic_text"),
          "<pre>not_italic_text</pre>",
          "not_italic_text => not_italic_text"
        );
      });
      test("Multiple-word emphasis.", function () {
        equal(
          this.editor_.processText_("_italic text_"),
          "<pre><em>&#x5f;italic text&#x5f;</em></pre>",
          "_italic text_ => <em>&#x5f;italic text&#x5f;</em>"
        );
        equal(
          this.editor_.processText_("_ita_lic te_xt_"),
          "<pre><em>&#x5f;ita_lic te_xt&#x5f;</em></pre>",
          "_ita_lic te_xt_ => <em>&#x5f;ita_lic te_xt&#x5f;</em>"
        );
      });

    /** CODE **/
      test("Single-word code.", function () {
        equal(
          this.editor_.processText_("`code`"),
          "<pre><code>&#x60;code&#x60;</code></pre>",
          "`code` => <code>&#x60;code&#x60;</code>"
        );
        equal(
          this.editor_.processText_("[`code`][]"),
          "<pre>[<code>&#x60;code&#x60;</code>][]</pre>",
          "[`code`][] => [<code>&#x60;code&#x60;</code>][]"
        );
        equal(
          this.editor_.processText_("first `code`"),
          "<pre>first <code>&#x60;code&#x60;</code></pre>",
          "first `code` => first <code>&#x60;code&#x60;</code>"
        );
        equal(
          this.editor_.processText_("sentence `code`."),
          "<pre>sentence <code>&#x60;code&#x60;</code>.</pre>",
          "sentence `code`. => sentence <code>&#x60;code&#x60;.</code>"
        );
        equal(
          this.editor_.processText_("sentence `code`,"),
          "<pre>sentence <code>&#x60;code&#x60;</code>,</pre>",
          "sentence `code`, => sentence <code>&#x60;code&#x60;,</code>"
        );
        equal(
          this.editor_.processText_("sentence `code`;"),
          "<pre>sentence <code>&#x60;code&#x60;</code>;</pre>",
          "sentence `code`; => sentence <code>&#x60;code&#x60;;</code>"
        );
        equal(
          this.editor_.processText_("sentence `code`:"),
          "<pre>sentence <code>&#x60;code&#x60;</code>:</pre>",
          "sentence `code`: => sentence <code>&#x60;code&#x60;:</code>"
        );
        equal(
          this.editor_.processText_("caret `code`{{ CARETMARKER }}"),
          "<pre>caret <code>&#x60;code&#x60;</code><mark id=\"caretmarker\"></mark></pre>",
          "caret `code`| => caret `code`<mark id=\"caretmarker\"></mark>"
        );
        equal(
          this.editor_.processText_("`code` last"),
          "<pre><code>&#x60;code&#x60;</code> last</pre>",
          "`code` last => <code>&#x60;code&#x60; last</code>"
        );
        equal(
          this.editor_.processText_("`code` `also`"),
          "<pre><code>&#x60;code&#x60;</code> <code>&#x60;also&#x60;</code></pre>",
          "`code` `also` => <code>&#x60;code&#x60;</code> <code>&#x60;also&#x60;</code>"
        );
      });
      test("Multiple-word code.", function () {
        equal(
          this.editor_.processText_("`code text`"),
          "<pre><code>&#x60;code text&#x60;</code></pre>",
          "`code text` => <code>&#x60;code text&#x60;</code>"
        );
      });

    </script>
  </body>
</html>
